// my first program in C++
#include <iostream>
#include "Tmatrix.h"
#include "Tvector.h"
#include "Tsparse_vector.h"
#include "Tsparse_matrix.h"

using namespace std;

int main()
{
    cout << "----- TESTING linear system solver -----" << endl;

    /* ----- TESTING linear system solver ----- */	
		
	TNoddy::Tmatrix<double> A(4,3,0.0);           // Declare 4x3 matrix object
    A(0,0) = 1; A(0,1) = 2; A(0,2) = 3;
    A(1,0) = 4; A(1,1) = 5; A(1,2) = 6;
    A(2,0) = 7; A(2,1) = 7; A(2,2) = 1;
    A(3,0) = 2; A(3,1) = 3; A(3,2) = 5;
    cout << "A = " << A << endl;

    TNoddy::Tmatrix<double> B(4,2,1.0);           // Declare 4x2 matrix object
    cout << "B = " << B << endl;

    TNoddy::Tmatrix<double> X = A.solve(B);       // Test the solve method (matrix)
    cout << "X = " << X << endl;
    cout << "X.rows() = " << X.rows() << endl;
    cout << "X.cols() = " << X.cols() << endl;


	TNoddy::Tvector<double> b_vec(4,1.0);
	TNoddy::Tvector<double> x_vec(4,0.0);
	x_vec = A.solve(b_vec);

	cout << "b_vec = " << b_vec << endl;
	cout << "x_vec = " << x_vec << endl;
    cout << endl;
    cout << "----- TESTING sparse linear system solver -----" << endl;

    /* ----- TESTING sparse linear system solver ----- */

    size_t N = 10;
    TNoddy::Tsparse_matrix<double> A_matrix(N,N);
    for (size_t i=0; i<N; ++i)
    {
            A_matrix(i,i) = 0.435 * (i + 1.0);
    }

    TNoddy::Tvector<double> B_vector(N,0.435);
    TNoddy::Tvector<double> X_vector(N,0.0);
    
	X_vector = A_matrix.solve( B_vector );
    cout << "B_vector = " << B_vector << endl;
    cout << "X_vector = " << X_vector << endl;
    

	cout << "FINISHED" << endl;

}
